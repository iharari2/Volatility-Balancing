from typing import Protocol, Optional, Iterable
from app.domain.models import Position, Order, Trade, Event

class PositionRepo(Protocol):
    def get(self, position_id: str) -> Optional[Position]: ...
    def save(self, pos: Position) -> None: ...

class OrderRepo(Protocol):
    def get(self, order_id: str) -> Optional[Order]: ...
    def save(self, order: Order) -> None: ...
    def find_by_idempotency(self, key: str) -> Optional[Order]: ...

class TradeRepo(Protocol):
    def save(self, trade: Trade) -> None: ...

class EventRepo(Protocol):
    def append(self, evt: Event) -> None: ...
    def list_for_position(self, position_id: str) -> Iterable[Event]: ...
